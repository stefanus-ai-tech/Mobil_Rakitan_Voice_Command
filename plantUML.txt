@startuml
!theme vibrant

title ESP32 Voice-Controlled Robot System

skinparam BackgroundColor FFFFFF
skinparam shadowing false
skinparam roundcorner 10

' User Interface
package "User Interface" {
    component [Web Browser] as UI
    note right of UI
    Fungsi:
    - Kontrol manual robot
    - Rekam perintah suara
    - Kirim audio ke ESP32
    end note
}

' ESP32 Core
package "ESP32 Firmware" {
    component [NetworkManager] as Net
    component [GroqClient] as AI
    component [MotorControl] as Motor
    component [LCDHandler] as LCD
    component [Main Loop] as Main
    database [Config Files] as Conf
}

' Cloud Services
cloud "Groq Cloud API" {
    component [Whisper STT] as STT
    component [Llama 4 LLM] as LLM
}

' Main Flow
UI --> Net : (1) Manual Control\nHTTP GET
UI --> Net : (2) Upload Audio\nHTTP POST

Net --> Motor : Direct Move
Net --> AI : Audio Buffer
Net ..> LCD : Update Status

AI --> STT : (3) POST Audio
STT --> AI : Return Text

AI --> LLM : (4) POST Text
LLM --> AI : Return JSON

AI --> Motor : (5) Execute Command
AI ..> LCD : Show Result

Main --> Motor : (6) Monitor Sensors
Motor --> Main : Distance Data
Main --> Motor : Emergency Stop

Conf --> Net : WiFi Config
Conf --> AI : API Key
Conf --> Motor : Pin Defs

legend bottom
Alur Kerja:
1. User kirim perintah (manual/suara)
2. Audio diproses oleh Whisper
3. Teks dikirim ke Llama 4
4. Robot eksekusi perintah
5. Sensor monitor keamanan
endlegend

@enduml
